CREATE DATABASE IF NOT EXISTS DATA_SCIENCE;
USE DATA_SCIENCE;
CREATE TABLE DATASCIENCEJOBS_DATA(
WORK_YEAR INT,
JOB_TITLE VARCHAR(80),
JOB_CATEGORY VARCHAR(70),
SALARY_CURRENCY VARCHAR(20),
SALARY INT,
SALARY_IN_USD INT,
EMPLOYEE_RESIDENCE VARCHAR(50),
EXPERIENCE_LEVEL VARCHAR(30),
EMPLOYMENT_TYPE VARCHAR(30),
WORK_SETTING VARCHAR(30),
COMPANY_LOCATION VARCHAR(40),
COMPANY_SIZE VARCHAR(5));

LOAD DATA INFILE
'D:/jobs_in_datascience.csv'
INTO TABLE DATASCIENCEJOBS_DATA
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

SELECT * FROM DATASCIENCEJOBS_DATA;

/*Q-1 Find Salary trends with respect to work year?*/
SELECT SUM( DISTINCT SALARY) , WORK_YEAR FROM DATASCIENCEJOBS_DATA GROUP BY WORK_YEAR;

SELECT DISTINCT JOB_TITLE,WORK_YEAR,SALARY AS CURRENT_SALARY,LAG(SALARY) OVER (PARTITION BY JOB_TITLE ORDER BY SALARY DESC) AS PREVIOUS_SALARY 
FROM DATASCIENCEJOBS_DATA; 

/*Q-2 Find salary distribution across various specialized Roles namley Data Scientist, Data Engineer and Data Analyst.*/
SELECT SUM(DISTINCT SALARY) AS SALARY_DISTRIBUTION,JOB_TITLE FROM DATASCIENCEJOBS_DATA WHERE JOB_TITLE 
IN('Data Scientist','Data Engineer','Data Analyst') GROUP BY JOB_TITLE;

/*Q-3 Find unique Job Title for which salary range is between 80,000 and 2,00,000?*/
SELECT DISTINCT JOB_TITLE,SALARY FROM DATASCIENCEJOBS_DATA WHERE SALARY BETWEEN 80000 AND 200000;

/*Q-4 Find Employee Residence whose Salary is in 'USD' and Experience level as 'Senior'?*/
SELECT EMPLOYEE_RESIDENCE,SALARY_IN_USD,EXPERIENCE_LEVEL FROM DATASCIENCEJOBS_DATA WHERE 
SALARY_CURRENCY = 'USD' AND EXPERIENCE_LEVEL = 'Senior';

/*Q-5 Find Total Salary in USD for work setting as 'In-person'?*/
SELECT SUM(SALARY_IN_USD) AS TOTALSALARY_INUSD,WORK_SETTING FROM DATASCIENCEJOBS_DATA WHERE WORK_SETTING = 'In-person';

/*Q-6 Find the most common Job category with respect to Job Title?*/
SELECT COUNT(JOB_CATEGORY) AS MOST_COMMON, JOB_TITLE FROM DATASCIENCEJOBS_DATA GROUP BY JOB_TITLE ORDER BY 
MOST_COMMON DESC LIMIT 1;

/*Q-7 Find average salary based on Employment type with respect to work year and Job Title?*/
SELECT AVG(SALARY),EMPLOYMENT_TYPE,WORK_YEAR,JOB_TITLE FROM DATASCIENCEJOBS_DATA GROUP BY EMPLOYMENT_TYPE,WORK_YEAR,JOB_TITLE
ORDER BY EMPLOYMENT_TYPE,AVG(SALARY);

/*Q-8 Find ratio of medium to large for company size*/
SELECT company_size, COUNT( CASE WHEN COMPANY_SIZE = 'M' THEN 1 end) AS MEDIUM_RATIO,
COUNT( CASE WHEN COMPANY_SIZE = 'L' THEN 1 END) AS LARGE_RATIO,count(*) FROM DATASCIENCEJOBS_DATA
WHERE COMPANY_SIZE IN ("M","L") GROUP BY COMPANY_SIZE;
SELECT CAST(COUNT(COMPANY_SIZE IN('M'))/COUNT(COMPANY_SIZE IN('L')) AS FLOAT)
AS RATIO FROM DATASCIENCEJOBS_DATA;

SELECT COUNT(DISTINCT COMPANY_SIZE)
((SELECT COUNT(COMPANY_SIZE),COMPANY_SIZE FROM DATASCIENCEJOBS_DATA GROUP BY COMPANY_SIZE ORDER BY COUNT(COMPANY_SIZE) DESC LIMIT 1)
AS A1,(SELECT COUNT(COMPANY_SIZE) FROM DATASCIENCEJOBS_DATA GROUP BY COMPANY_SIZE) AS B1);

/*Q-9 Find Job Title with respect to work year where 'salary number' is equal to 'salary in USD number'*/
SELECT DISTINCT JOB_TITLE,WORK_YEAR,SALARY,SALARY_IN_USD FROM DATASCIENCEJOBS_DATA WHERE SALARY = SALARY_IN_USD;

/*Q-10 Classify unique experience level for all records*/
SELECT DISTINCT EXPERIENCE_LEVEL ,WORK_YEAR,JOB_TITLE,JOB_CATEGORY,SALARY_CURRENCY,SALARY,SALARY_IN_USD,EMPLOYEE_RESIDENCE,
EMPLOYMENT_TYPE,WORK_SETTING,COMPANY_LOCATION,COMPANY_SIZE FROM DATASCIENCEJOBS_DATA ORDER BY EXPERIENCE_LEVEL;